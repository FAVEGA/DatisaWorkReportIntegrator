from datisaworkreportintegrator.parser import parse_waybill_closing_file, parse_float

waybill_closing_file = """"220311    ";"";83824;"14/07/14";1;"02";0;0;0;;;;7;"01        ";"04        ";1;2;1;"001";"        ";"        ";"";"DESGLOSE VENTANAS 02*2029";"DESGLOSE FONTANERIA 90*110";"ASPERSION 90*191";"C. METAGA;1914";"";0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0;0,00;0,000;"EQUIP";"2";0;"!2";1,000000;0,00;0;;"";0;"        "
"220311    ";"";83824;"/               ";"REF.LOARRE 1";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"EQUIPAMIENTO 2 NAVES CEBO 60x14 m.";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;1;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"OPCION TOLVA ERRA";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;2;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;3;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;8;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"**Alimentacion:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;9;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"1201000065      ";"TRANSPORTADOR T75 65 M.";4,00;1767,00;"35+3";"0.77";0,00;0,00;1;0;1114,09;"        ";3;"02";5371;10;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"Incluye:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;11;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"4 Motorreductor con cuadro electrico";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;12;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"4 Cajetin de silo doble";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;13;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"4 Unidad final con final de carrera";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;14;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"80 bajadas telescopicas";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;15;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"230411          ";"SUPLEMENTO ALAMBRE INOX";240,00;2,85;"35";"1.00";0,00;0,00;1;0;1,85;"        ";3;"02";5371;16;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;19;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"**Tornos automaticos de ventanas:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;24;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"1703301         ";"ELEVADOR COMPACT F15";4,00;596,00;"35";"1.00";0,00;0,00;1;0;387,40;"        ";3;"02";5371;25;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"170317          ";"CAJA POTENCIA CW 12 V. VER-2.1";4,00;74,00;"35";"1.00";0,00;0,00;1;0;48,10;"        ";3;"02";5371;26;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"17030303        ";"CARGADOR BATERIA F-886";4,00;125,00;"35+10";"0.4";0,00;0,00;1;0;73,13;"        ";3;"02";5371;27;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"17030404        ";"BATERIA 12V. 70 Ah.";4,00;166,00;"35+10";"0.4";0,00;0,00;1;0;97,11;"        ";3;"02";5371;28;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;29;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"**Puertas peatonales:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;30;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"18270109002000  ";"PUERTA PVC 1 HOJA 0900X2000";10,00;250,00;"48";"0.4";0,00;0,00;1;0;130,00;"        ";3;"02";5371;31;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;32;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"**Fontaneria a tolva:";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;33;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/24             ";"LINEA AEREA POLIETILENO D32 INOX";4,00;500,00;"0";"0.4";0,00;0,00;1;0;500,00;"        ";3;"02";5371;34;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"Incluye suspensio INOX.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;35;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;36;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"**Cierre chimeneas:";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;37;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/18             ";"ACCESORIOS CIERRE CHIMENEAS COLECTIVO";40,00;35,00;"0";"0.4";0,00;0,00;1;0;35,00;"        ";3;"02";5371;38;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"1703301         ";"ELEVADOR COMPACT F15";2,00;596,00;"35";"1";0,00;0,00;1;0;387,40;"        ";3;"02";5371;39;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"170317          ";"CAJA POTENCIA CW 12 V. VER-2.1";2,00;74,00;"35";"1.00";0,00;0,00;1;0;48,10;"        ";3;"02";5371;40;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"0101            ";"DESCUENTO ESPECIAL";-1,00;435,00;"0";"1";0,00;0,00;1;0;435,00;"        ";3;"02";5371;41;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;42;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"900905001       ";"MONTAJE JOSE MARIA";2,00;2250,00;"";"0.00";0,00;0,00;1;0;2250,00;"        ";3;"02";5371;49;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"Todos los materiales detallados";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;50;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"incluyen montaje.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;51;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"El cliente aportara un peon.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5371;52;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5371;53;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"0108            ";"OPERACION CON INVERSION DEL SUJE";0,00;0,00;"0";"0.00";0,00;0,00;1;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83824;"/               ";"";0,00;0,00;"";"";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"14/07/14";1;"02";0;0;0;;;;7;"01        ";"04        ";1;2;1;"001";"        ";"        ";"";"DESGLOSE VENTANAS 02*2029";"DESGLOSE FONTANERIA 90*110";"ASPERSION 90*191";"C. METAGA;1914";"";0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0;0,00;0,000;"EQUIP2";"2";0;"!2";1,000000;0,00;0;;"";0;"        "
"220311    ";"";83825;"/               ";"REF.LOARRE 2";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"EQUIPAMIENTO 2 NAVES CEBO 60x14 m.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;1;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"OPCION TOLVA ERRA";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;2;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;3;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"**Alimentacion:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;9;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"1201000065      ";"TRANSPORTADOR T75 65 M.";4,00;1767,00;"35+3";"0.77";0,00;0,00;1;0;1114,09;"        ";3;"02";5372;10;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"Incluye:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;11;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"4 Motorreductor con cuadro electrico";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;12;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"4 Cajetin de silo doble";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;13;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"4 Unidad final con final de carrera";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;14;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"80 bajadas telescopicas";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;15;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"230411          ";"SUPLEMENTO ALAMBRE INOX";240,00;2,85;"35";"1.00";0,00;0,00;1;0;1,85;"        ";3;"02";5372;16;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;19;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"**Tornos automaticos de ventanas:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;24;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"1703301         ";"ELEVADOR COMPACT F15";4,00;596,00;"35";"1.00";0,00;0,00;1;0;387,40;"        ";3;"02";5372;25;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"170317          ";"CAJA POTENCIA CW 12 V. VER-2.1";4,00;74,00;"35";"1.00";0,00;0,00;1;0;48,10;"        ";3;"02";5372;26;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"17030303        ";"CARGADOR BATERIA F-886";4,00;125,00;"35+10";"0.4";0,00;0,00;1;0;73,13;"        ";3;"02";5372;27;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"17030404        ";"BATERIA 12V. 70 Ah.";4,00;166,00;"35+10";"0.4";0,00;0,00;1;0;97,11;"        ";3;"02";5372;28;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;29;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"**Puertas peatonales:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;30;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"18270109002000  ";"PUERTA PVC 1 HOJA 0900X2000";10,00;250,00;"48";"0.4";0,00;0,00;1;0;130,00;"        ";3;"02";5372;31;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;32;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"**Fontaneria a tolva:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;33;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/24             ";"LINEA AEREA POLIETILENO D32 INOX";4,00;500,00;"0";"0.4";0,00;0,00;1;0;500,00;"        ";3;"02";5372;34;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"Incluye suspensio INOX.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;35;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;36;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"**Cierre chimeneas:";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;37;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/18             ";"ACCESORIOS CIERRE CHIMENEAS COLECTIVO";40,00;35,00;"0";"0.4";0,00;0,00;1;0;35,00;"        ";3;"02";5372;38;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"1703301         ";"ELEVADOR COMPACT F15";2,00;596,00;"35";"1.00";0,00;0,00;1;0;387,40;"        ";3;"02";5372;39;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"170317          ";"CAJA POTENCIA CW 12 V. VER-2.1";2,00;74,00;"35";"1.00";0,00;0,00;1;0;48,10;"        ";3;"02";5372;40;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"0101            ";"DESCUENTO ESPECIAL";-1,00;435,00;"0";"1";0,00;0,00;1;0;435,00;"        ";3;"02";5372;41;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;42;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"900905001       ";"MONTAJE JOSE MARIA";2,00;2250,00;"";"0.00";0,00;0,00;1;0;2250,00;"        ";3;"02";5372;49;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"Todos los materiales detallados";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;50;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"incluyen montaje.";0,00;0,00;"";"0";0,00;0,00;1;0;0,00;"        ";3;"02";5372;51;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"El cliente aportara un peon.";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"02";5372;52;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"0108            ";"OPERACION CON INVERSION DEL SUJE";0,00;0,00;"0";"0.00";0,00;0,00;1;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"220311    ";"";83825;"/               ";"";0,00;0,00;"";"";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"""


def test_parse_waybill_closing_file():
    result = parse_waybill_closing_file(waybill_closing_file)
    assert len(result.keys()) == 2
    assert '83824' in result.keys()
    assert '83825' in result.keys()
    assert result['83824'] == 4500
    assert result['83825'] == 4500



waybill_closing_file_with_decimals = """"
440355    ";"";87600;"04/03/15";1;"07";0;0;0;0;0;0;1;"01        ";"00        ";1;2;1;"001";"        ";"        ";"TXT PAGADOS";"";"";"";"";"";0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;0,00;9;0,00;0,000;"";"2";0;"!2";1,000000;0,00;0;;"";0;"        "
"440355    ";"";87600;"1201000060      ";"TRANSPORTADOR T75 60 M.";1,00;1723,00;"20";"2.71";0,00;0,00;1;0;1378,40;"        ";3;"03";1952;11;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"/               ";"** CAJETIN DOBLE";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"03";1952;12;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"/               ";"** CON 29 CAIDAS";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"03";1952;13;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"/               ";"** TODO EL MATERIAL NECESARIO";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";3;"03";1952;14;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"900905001       ";"MONTAJE JOSE MARIA";2,50;252,00;"0";"0.00";0,00;0,00;1;0;252,00;"        ";3;"03";1952;15;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"/               ";"** incluye reparacion de 2 lineas más";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"415             ";"PORTES TXT PP..........";1,00;65,53;"0";"0.00";0,00;0,00;1;0;65,53;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"/               ";"";0,00;0,00;"";"0";0,00;0,00;0;0;0,00;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"440355    ";"";87600;"120100201       ";"MOTORREDUCTOR MET 1C.V. 3F";2,00;211,00;"20";"2.71";0,00;0,00;1;0;168,80;"        ";0;"";0;0;"";"        ";"";0;"";0;"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";"";""
"""


def test_parse_waybill_closing_file_with_decimals():
    result = parse_waybill_closing_file(waybill_closing_file_with_decimals)
    assert '87600' in result.keys()
    assert result['87600'] == 630


def test_parse_float():
    assert parse_float("2,5") == 2.5
    assert parse_float("2,50") == 2.5
    assert parse_float("2.5") == 2.5
    assert parse_float("2.50") == 2.5
    assert parse_float("2250") == 2250
    assert parse_float("2250,50") == 2250.50
    assert parse_float("2250.50") == 2250.50
    assert parse_float("2,250.50") == 2250.50
    assert parse_float("2.250,50") == 2250.50
